name: Numpy Neural Network CI

on: 
    push: 
        branches: [dev]
    pull_request:
        branches: [dev]

jobs:
    test:
        name: Run Unit and E2E Tests
        runs-on: ubuntu-latest

        steps:
        -   name: Checkout Repository
            uses: actions/checkout@v4

        -   name: Set up Python 3.13
            uses: actions/setup-python@v5
            with:
                python-version: '3.13'
        
        -   name: Install Poetry
            run: |
                python -m pip install poetry==2.0.0
        
        -   name: Configure Poetry
            run: |
                python -m poetry config virtualenvs.in-project true
        
        -   name: Cache Poetry virtualenv
            uses: actions/cache@v4
            with:
                path: ./.venv
                key: ${{ runner.os }}-venv-${{ hashFiles('**/poetry.lock') }}
                restore-keys: |
                    ${{ runner.os }}-venv-

        -   name: Install Dependencies
            run: |
                poetry install --no-interaction --no-root
        
        -   name: Run Unit Tests
            run: |
                poetry run python -m unittest discover tests/unit -p "test_*.py"
        
        -   name: Run E2E Tests
            run: |
                poetry run python -m unittest discover tests/e2e -p "test_*.py"